{# templates/partials/sidebar.html #}
{% load user_extras %}
<aside id="app-sidebar"
       class="fixed top-14 left-0 h-[calc(100vh-56px)] w-64 lg:w-72 bg-white border-r shadow z-30 transition-transform duration-200 translate-x-0 flex flex-col">
  <div class="p-4 flex items-center justify-between border-b">
    <div class="flex items-center gap-3">
      {% if request.user.profile.avatar %}
        <img src="{{ request.user.profile.avatar.url }}" alt="avatar" class="w-12 h-12 rounded-full object-cover">
      {% else %}
        <div class="w-12 h-12 rounded-full bg-indigo-100 flex items-center justify-center font-semibold text-indigo-700">
          {{ request.user|initials }}
        </div>
      {% endif %}
      <div class="leading-tight">
        <div class="font-semibold">{{ request.user.username }}</div>
        <div class="text-xs text-gray-500">{{ request.user.email }}</div>
      </div>
    </div>
    <button
      class="text-gray-500 hover:text-gray-700 lg:hidden"
      onclick="document.getElementById('app-sidebar').classList.toggle('-translate-x-full')">
      ✕
    </button>
  </div>

  <nav class="p-3 text-sm">
    <a href="{% url 'exams:my_profile' %}"
       class="block px-3 py-2 rounded hover:bg-gray-100 {% if active_menu == 'profile' %}bg-indigo-50 text-indigo-700 font-medium{% endif %}">
      Mon profile
    </a>

    <a href="{% url 'exams:index' %}"
       class="block px-3 py-2 rounded hover:bg-gray-100 {% if active_menu == 'exams' %}bg-indigo-50 text-indigo-700 font-medium{% endif %}">
      Accueil
    </a>

    <a href="#" onclick="window.history.length>1 ? history.back() : window.location='{{ request.path }}'; return false;"
       class="block px-3 py-2 rounded hover:bg-gray-100 {% if active_menu == 'packs' %}bg-indigo-50 text-indigo-700 font-medium{% endif %}">
      Packs Épreuves + Corrigés
    </a>

    <a href="{% url 'exams:free_sample' %}"
       class="block px-3 py-2 rounded hover:bg-gray-100 {% if active_menu == 'free_sample' %}bg-indigo-50 text-indigo-700 font-medium{% endif %}">
      Extraits Épreuves + Corrigés
    </a>

    <a href="{% url 'exams:chatbot' %}"
       class="block px-3 py-2 rounded hover:bg-gray-100 {% if active_menu == 'qa' %}bg-indigo-50 text-indigo-700 font-medium{% endif %}">
      Poser des questions à notre chatbot
    </a>

    <a href="{% url 'forum:index' %}"
       class="block px-3 py-2 rounded hover:bg-gray-100 {% if active_menu == 'forum' %}bg-indigo-50 text-indigo-700 font-medium{% endif %}">
      Forum d’échange et de discussion
    </a>  
  </nav>
    
    <!-- Bouton déconnexion tout en bas -->
    <div class="mt-auto p-4 border-t">
        <form action="{% url 'account_logout' %}" method="post" class="w-full">
        {% csrf_token %}
        <button type="submit"
                class="w-full inline-flex items-center justify-center px-4 py-2 rounded-xl bg-red-600 text-white hover:bg-red-700 focus:outline-none focus:ring">
            Se déconnecter
        </button>
        </form>
    </div>
</aside>

<script>
  // Ouvrir/fermer sur mobile : on part ouvert en desktop, caché pas nécessaire
</script>
